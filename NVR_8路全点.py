from selenium import webdriver
from time import sleep
import json
from selenium.webdriver.support.select import Select
def NvrUpgrade():
    IP = input("输入ip: ")
    ele = webdriver.Ie()
    ele.maximize_window()
    ele.get("http://"+ IP +"/login.html")
    sleep(5)
    ele.find_element_by_id('loginuserName').clear()
    sleep(1)
    ele.find_element_by_id('loginuserName').send_keys('admin')
    sleep(1)
    ele.find_element_by_id('laLogin').click()
    sleep(1)
    ele.find_element_by_id('span-log').click()
    ele.find_element_by_id('span-log').click()#点系统日志
    sleep(1)
    ele.switch_to.frame('paramSettingFrame')
    sleep(1)
    ele.find_element_by_class_name('searchbtn').click()#搜索所有日志
    sleep(3)
    s = ele.find_element_by_id('logType')
    Select(s).select_by_value('2')
    
    ele.find_element_by_class_name('searchbtn').click()#搜索报警日志
    sleep(3)
    Select(s).select_by_value('3')
    print('搜索异常日志')
    ele.find_element_by_class_name('searchbtn').click()#搜索异常日志
    sleep(3)
    Select(s).select_by_value('4')
    print('搜索操作日志')
    ele.find_element_by_class_name('searchbtn').click()#搜索操作日志
    sleep(3)
    Select(s).select_by_value('5')
    print('搜索信息日志')
    ele.find_element_by_class_name('searchbtn').click()#搜索信息日志
    sleep(1)
    ele.switch_to.default_content()
    print('点参数配置')
    ele.find_element_by_id('span-set').click()#点参数配置
    ele.find_element_by_id('span-set').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub1_1Span').click()
    sleep(1)
    ele.find_element_by_id('sub1_2Span').click()
    sleep(1)
    ele.switch_to.frame('paramSettingFrame')
    print('点UPNP开关')
    ele.find_element_by_id('httpen').click()#点UPNP开关
    sleep(1)
    print('点HTTP开关')
    ele.find_element_by_id('rtspen').click()#点HTTP开关
    sleep(1)
    print('保存')
    ele.find_element_by_id('btnSave').click()
    sleep(1)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub1_3').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('enable').click()
    ele.find_element_by_id('btnSave').click()
    sleep(1)
    print('点p2p开关，并保存')
    ele.find_element_by_id('btnRefresh').click()
    sleep(1)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    print('点邮件，要手动测试')
    ele.find_element_by_id('sub1_4Span').click()
    sleep(1)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub1_5Span').click()
    sleep(1)
    ele.switch_to.frame('paramSettingFrame')
    print('点ddns开关')
    ele.find_element_by_id('ddnsenable').click()
    sleep(1)
    ele.find_element_by_id('btnSave').click()
    sleep(1)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub2Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('channel_no')
    s = ele.find_element_by_id('channel_no')
    Select(s).select_by_value('0')
    sleep(2)
    Select(s).select_by_value('1')
    sleep(2)
    Select(s).select_by_value('2')
    sleep(2)
    Select(s).select_by_value('3')
    sleep(2)
    Select(s).select_by_value('4')
    sleep(2)
    Select(s).select_by_value('5')
    sleep(2)
    Select(s).select_by_value('6')
    sleep(2)
    Select(s).select_by_value('7')
    sleep(2)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub2_2Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('channelSel')
    a = ele.find_element_by_id('channelSel')
    Select(a).select_by_value('0')
    sleep(2)
    Select(a).select_by_value('1')
    sleep(2)
    Select(a).select_by_value('2')
    sleep(2)
    Select(a).select_by_value('3')
    sleep(2)
    Select(a).select_by_value('4')
    sleep(2)
    Select(a).select_by_value('5')
    sleep(2)
    Select(a).select_by_value('6')
    sleep(2)
    Select(a).select_by_value('7')
    sleep(2)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub2_3Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('chn_no')
    b = ele.find_element_by_id('chn_no')
    Select(b).select_by_value('0')
    sleep(2)
    Select(b).select_by_value('1')
    sleep(2)
    Select(b).select_by_value('3')
    sleep(2)
    Select(b).select_by_value('4')
    sleep(2)
    Select(b).select_by_value('5')
    sleep(2)
    Select(b).select_by_value('6')
    sleep(2)
    Select(b).select_by_value('7')
    sleep(2)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub3Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('channel')
    c = ele.find_element_by_id('channel')
    Select(c).select_by_value('0')
    sleep(2)
    Select(c).select_by_value('1')
    sleep(2)
    Select(c).select_by_value('3')
    sleep(2)
    Select(c).select_by_value('4')
    sleep(2)
    Select(c).select_by_value('5')
    sleep(2)
    Select(c).select_by_value('6')
    sleep(2)
    Select(c).select_by_value('7')
    sleep(2)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub3_2Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('btnFormat').click()
    sleep(2)
    ele.find_element_by_id('tr_0').click()
    print('格式化硬盘')
    ele.find_element_by_id('btnFormat').click()#到了格式化硬盘这个
    sleep(2)
    try:
        a = ele.switch_to.alert
        a.accept()
        sleep(60)
    except:
        print("没有找到弹窗！！！")    
    ele.find_element_by_id('btnRefresh').click()#刷新格式化硬盘
    sleep(2)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub4Span').click()
    sleep(2)
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('alarm_type')
    d = ele.find_element_by_id('alarm_type')
    Select(d).select_by_value('1')#移动侦测
    sleep(2)
    ele.find_element_by_id('channel')
    e = ele.find_element_by_id('channel')
    Select(e).select_by_value('0')
    sleep(2)
    Select(e).select_by_value('1')
    sleep(2)
    Select(e).select_by_value('3')
    sleep(2)
    Select(e).select_by_value('4')
    sleep(2)
    Select(e).select_by_value('5')
    sleep(2)
    Select(e).select_by_value('6')
    sleep(2)
    Select(e).select_by_value('7')
    sleep(2)
    Select(d).select_by_value('2')
    sleep(5)
    ele.find_element_by_id('channel')
    e = ele.find_element_by_id('channel')
    Select(e).select_by_value('0')
    sleep(2)
    Select(e).select_by_value('1')
    sleep(2)
    Select(e).select_by_value('3')
    sleep(2)
    Select(e).select_by_value('4')
    sleep(2)
    Select(e).select_by_value('5')
    sleep(2)
    Select(e).select_by_value('6')
    sleep(2)
    Select(e).select_by_value('7')
    sleep(2)
    Select(d).select_by_value('0')
    sleep(5)
    ele.find_element_by_id('channel')
    e = ele.find_element_by_id('channel')
    Select(e).select_by_value('0')
    sleep(2)
    Select(e).select_by_value('1')
    sleep(2)
    Select(e).select_by_value('3')
    sleep(2)
    Select(e).select_by_value('4')
    sleep(2)
    Select(e).select_by_value('5')
    sleep(2)
    Select(e).select_by_value('6')
    sleep(2)
    Select(e).select_by_value('7')
    sleep(2)
    Select(d).select_by_value('0')
    sleep(5)
    ele.find_element_by_id('channel')
    e = ele.find_element_by_id('channel')
    Select(e).select_by_value('3')
    sleep(2)
    Select(e).select_by_value('1')
    sleep(2)
    Select(e).select_by_value('3')
    sleep(2)
    Select(e).select_by_value('4')
    sleep(2)
    Select(e).select_by_value('5')
    sleep(2)
    Select(e).select_by_value('6')
    sleep(2)
    Select(e).select_by_value('7')
    sleep(2)
    print('通告管理点完了')
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub4_2Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('channel')
    f = ele.find_element_by_id('channel')
    Select(f).select_by_value('3')
    sleep(2)
    Select(f).select_by_value('1')
    sleep(2)
    Select(f).select_by_value('3')
    sleep(2)
    Select(f).select_by_value('4')
    sleep(2)
    Select(f).select_by_value('5')
    sleep(2)
    Select(f).select_by_value('6')
    sleep(2)
    Select(f).select_by_value('7')
    sleep(5)
    print('点完越界了')
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub4_3Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('channel')
    g = ele.find_element_by_id('channel')
    Select(g).select_by_value('3')
    sleep(2)
    Select(g).select_by_value('1')
    sleep(2)
    Select(g).select_by_value('3')
    sleep(2)
    Select(g).select_by_value('4')
    sleep(2)
    Select(g).select_by_value('5')
    sleep(2)
    Select(g).select_by_value('6')
    sleep(2)
    Select(g).select_by_value('7')
    sleep(5)
    print('点完人形了')
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub4_4Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('channel')
    h = ele.find_element_by_id('channel')
    Select(h).select_by_value('3')
    sleep(2)
    Select(h).select_by_value('1')
    sleep(2)
    Select(h).select_by_value('3')
    sleep(2)
    Select(h).select_by_value('4')
    sleep(2)
    Select(h).select_by_value('5')
    sleep(2)
    Select(h).select_by_value('6')
    sleep(2)
    Select(h).select_by_value('7')
    sleep(5)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub4_5Span').click()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('alarm_type')
    ele.find_element_by_id('alarm_type')
    j = ele.find_element_by_id('alarm_type')
    Select(j).select_by_value('0')
    sleep(2)
    Select(j).select_by_value('1')
    sleep(2)
    Select(j).select_by_value('2')
    sleep(2)
    Select(j).select_by_value('3')
    sleep(2)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub5Span').click()
    sleep(2)
    print('常规配置')
    ele.find_element_by_id('sub5_2Span').click()
    sleep(2)
    ele.switch_to.frame('paramSettingFrame')
    print('现在点时间管理')
    ele.find_element_by_id('btnSave2').click()
    sleep(2)
    ele.find_element_by_id('ntpserviceen').click()
    sleep(2)
    ele.find_element_by_id('btnSave').click()
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub5_3Span').click()
    sleep(2)
    ele.find_element_by_id('sub5_4Span').click()
    sleep(2)
    ele.find_element_by_id('sub5_5Span').click()
    sleep(2)
    ele.switch_to.default_content()
    ele.switch_to.frame('paramSettingFrame')
    ele.find_element_by_id('sub6Span').click()
    sleep(10)
    print('点完了，没有点预览，查日志没有改时间，没有改内容，系统维护里的内容没有点！！！')
    ele.quit()
    
    
if __name__ == '__main__':
    NvrUpgrade()

    
   
